# SKU ID éªŒè¯æŠ¥å‘Š

## ğŸ” éªŒè¯ç›®æ ‡

éªŒè¯è®¢å•å’Œå•†å“æ˜¯å¦å¯ä»¥é€šè¿‡ SKU ID è¿›è¡ŒåŒ¹é…ã€‚

---

## ğŸ“Š å®é™…æ•°æ®å¯¹æ¯”

### 1. è®¢å•æ•°æ®ï¼ˆæ¥è‡ªè®¢å•APIåŸå§‹æ•°æ®ï¼‰

**è®¢å•ç¼–å·ï¼š** `211-07465491950711983`  
**å•†å“åç§°ï¼š** `(1pc) 100% Authentic POP MART Labubu 4.0 Heart Secret Series...`

```json
{
  "orderList": [{
    "orderSn": "211-07465491950711983",
    "skuId": 17614116879476,           // âŒ è®¢å•SKU ID
    "goodsId": 601104307271826,        // âŒ å•†å“ID
    "spec": "1pc",                     // âŒ è§„æ ¼æè¿°ï¼ˆä¸æ˜¯SKUè´§å·ï¼‰
    
    "productList": [{
      "productSkuId": 50668586641,     // âŒ äº§å“SKU ID
      "productId": 9903995070,         // âŒ äº§å“ID
      "extCode": "LBB4-A-US"           // âœ… SKUè´§å·ï¼ˆå”¯ä¸€åŒ¹é…ï¼‰
    }]
  }]
}
```

---

### 2. å•†å“æ•°æ®ï¼ˆæ¥è‡ªå•†å“APIï¼‰

**å•†å“åç§°ï¼š** `å•ç›’ POP MART LABUBU WHY SO SERIOUS THE MONSTERS...`

```json
{
  "productId": 5582141357,             // âŒ å•†å“IDï¼ˆå®é™…æ˜¯SPU IDï¼‰
  "productSkcId": 25949788870,         // âŒ SKC ID
  "extCode": "",                       // å•†å“çº§åˆ«æ²¡æœ‰extCode
  
  "productSkuSummaries": [{
    "productSkuId": 15099780999,       // âŒ SKU IDï¼ˆä¸è®¢å•ä¸åŒ¹é…ï¼‰
    "extCode": "LBB-MXT-1-US"          // âœ… SKUè´§å·
  }]
}
```

---

### 3. æ•°æ®åº“å•†å“æ•°æ®

**åŒ¹é…åˆ°çš„å•†å“ï¼ˆé€šè¿‡ extCode=LBB4-A-USï¼‰ï¼š**

```
Product.id:          563
Product.product_id:  53563922673      // âŒ ä¸è®¢å•çš„ä»»ä½•IDéƒ½ä¸åŒ¹é…
Product.sku:         LBB4-A-US        // âœ… ä¸è®¢å•çš„extCodeåŒ¹é…ï¼
Product.skc_id:      28785367833      // âŒ ä¸è®¢å•çš„ä»»ä½•IDéƒ½ä¸åŒ¹é…
Product.spu_id:      3075635380       // âŒ ä¸è®¢å•çš„ä»»ä½•IDéƒ½ä¸åŒ¹é…
```

---

## âŒ SKU ID æ— æ³•åŒ¹é…çš„åŸå› 

### IDå¯¹ç…§è¡¨

| æ¥æº | IDç±»å‹ | IDå€¼ | è¯´æ˜ |
|------|--------|------|------|
| **è®¢å•** | `skuId` | `17614116879476` | è®¢å•çº§åˆ«çš„SKU ID |
| **è®¢å•** | `productSkuId` | `50668586641` | äº§å“çº§åˆ«çš„SKU ID |
| **å•†å“API** | `productSkuId` | `15099780999` | å•†å“SKU ID |
| **å•†å“æ•°æ®åº“** | `product_id` | `53563922673` | æ•°æ®åº“å­˜å‚¨çš„å•†å“ID |

### ç»“è®º

1. **è®¢å•çš„ `skuId`** (`17614116879476`) â‰  **å•†å“çš„ `productSkuId`** (`15099780999`)
2. **è®¢å•çš„ `productSkuId`** (`50668586641`) â‰  **å•†å“çš„ `productSkuId`** (`15099780999`)
3. **è®¢å•çš„ä»»ä½•ID** â‰  **æ•°æ®åº“å•†å“çš„ `product_id`** (`53563922673`)

**æ‰€æœ‰æ•°å­—IDæ ¼å¼éƒ½ä¸åŒï¼Œæ— æ³•ç›´æ¥åŒ¹é…ï¼**

---

## âœ… å”¯ä¸€å¯é çš„åŒ¹é…æ–¹å¼

### é€šè¿‡ extCode (SKUè´§å·) åŒ¹é…

```python
# è®¢å•
order_sku = "LBB4-A-US"  # æ¥è‡ª orderList[].productList[].extCode

# å•†å“
product_sku = "LBB4-A-US"  # æ¥è‡ª Product.sku (æ•°æ®åº“)
                            # æˆ– productSkuSummaries[].extCode (API)

# åŒ¹é…
if order_sku == product_sku:
    print("âœ… åŒ¹é…æˆåŠŸï¼")
```

**åŒ¹é…ç»“æœï¼š**
- è®¢å• `extCode`: `LBB4-A-US`
- å•†å“ `SKU`: `LBB4-A-US`
- âœ… **å®Œç¾åŒ¹é…ï¼**

---

## ğŸ’¡ ä¸ºä»€ä¹ˆ SKU ID æ— æ³•åŒ¹é…ï¼Ÿ

### å¯èƒ½çš„åŸå› ï¼š

1. **ä¸åŒç³»ç»Ÿçš„ID**
   - è®¢å•ç³»ç»Ÿä½¿ç”¨è‡ªå·±çš„ SKU ID ç¼–å·è§„åˆ™
   - å•†å“ç³»ç»Ÿä½¿ç”¨å¦ä¸€å¥— SKU ID ç¼–å·è§„åˆ™
   - Temuå†…éƒ¨å¯èƒ½æœ‰å¤šä¸ªIDæ˜ å°„å…³ç³»

2. **åŒä¸€ä¸ªå•†å“åœ¨ä¸åŒä¸Šä¸‹æ–‡ä¸­çš„ä¸åŒID**
   - è®¢å•åˆ›å»ºæ—¶åˆ†é…çš„ `skuId`
   - å•†å“ç®¡ç†ä¸­çš„ `productSkuId`
   - æ•°æ®åº“å­˜å‚¨çš„ `product_id`
   - è¿™äº›IDå¯èƒ½éƒ½æŒ‡å‘åŒä¸€ä¸ªSKUï¼Œä½†æ•°å€¼ä¸åŒ

3. **SKUè´§å·æ˜¯å”¯ä¸€ç¨³å®šçš„æ ‡è¯†**
   - `extCode` (å¦‚ `LBB4-A-US`) æ˜¯å•†å®¶è‡ªå®šä¹‰çš„SKUè´§å·
   - åœ¨æ•´ä¸ªç³»ç»Ÿä¸­ä¿æŒä¸€è‡´
   - æ˜¯å”¯ä¸€å¯é çš„åŒ¹é…å­—æ®µ

---

## ğŸ“‹ å®æ–½å»ºè®®

### å½“å‰å®ç°ï¼ˆå·²æ­£ç¡®ï¼‰

```python
# sync_service.py ä¸­çš„ _create_order æ–¹æ³•

# ä»è®¢å•åŸå§‹æ•°æ®ä¸­æå–çœŸæ­£çš„SKUè´§å·
product_list = order_item.get('productList', [])
if product_list and len(product_list) > 0:
    product_sku = product_list[0].get('extCode')  # âœ… ä½¿ç”¨extCode
else:
    product_sku = order_item.get('spec')  # å¤‡ç”¨ï¼ˆè§„æ ¼æè¿°ï¼‰

# åŒ¹é…å•†å“
product = db.query(Product).filter(
    Product.shop_id == shop.id,
    Product.sku == product_sku  # âœ… é€šè¿‡SKUè´§å·åŒ¹é…
).first()
```

### ä¸æ¨èçš„æ–¹å¼ï¼ˆå·²éªŒè¯æ— æ³•åŒ¹é…ï¼‰

```python
# âŒ å°è¯•é€šè¿‡SKU IDåŒ¹é…ï¼ˆæ— æ³•å·¥ä½œï¼‰
order_sku_id = order_item.get('skuId')  # 17614116879476
product = db.query(Product).filter(
    Product.product_id == str(order_sku_id)  # âŒ æ— æ³•åŒ¹é…
).first()
```

---

## ğŸ¯ æœ€ç»ˆç»“è®º

è™½ç„¶è®¢å•å’Œå•†å“éƒ½åŒ…å«å¤šä¸ªIDå­—æ®µï¼ˆåŒ…æ‹¬SKU IDï¼‰ï¼Œä½†ç”±äºï¼š

1. âŒ **IDæ ¼å¼å®Œå…¨ä¸åŒ**
2. âŒ **æ•°å­—IDæ— æ³•ç›´æ¥å¯¹åº”**
3. âœ… **åªæœ‰ `extCode` (SKUè´§å·) ä¿æŒä¸€è‡´**

**å› æ­¤ï¼Œæœ€å¯é ä¸”å”¯ä¸€æœ‰æ•ˆçš„åŒ¹é…æ–¹å¼æ˜¯ï¼š**

```
è®¢å•çš„ extCode (SKUè´§å·) âŸ· å•†å“çš„ sku (SKUè´§å·)
```

---

## ğŸ“ éªŒè¯æ–¹æ³•

å·²é€šè¿‡ä»¥ä¸‹è„šæœ¬éªŒè¯ï¼š

1. `backend/scripts/check_product_sku_id.py` - æ£€æŸ¥å•†å“APIè¿”å›çš„SKU ID
2. `backend/scripts/compare_sku_ids.py` - å¯¹æ¯”è®¢å•å’Œå•†å“çš„SKU ID
3. `backend/scripts/list_all_fields.py` - åˆ—å‡ºæ‰€æœ‰å­—æ®µè¿›è¡Œå¯¹ç…§

éªŒè¯æ—¶é—´ï¼š2025-11-20  
éªŒè¯ç»“æœï¼šâœ… ç¡®è®¤ extCode æ˜¯å”¯ä¸€å¯é çš„åŒ¹é…å­—æ®µ

